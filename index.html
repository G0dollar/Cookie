<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="manifest" href="manifest.json">
<title>COOKIE V-3.41</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  margin: 0;
  font-family: "Segoe UI", Tahoma, sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  background: linear-gradient(rgba(0,0,0,0.3),rgba(0,0,0,0.3)), url("wood.jpg");
  background-size: cover;
  background-attachment: fixed;
  color: #4b2e18;
  min-height: 100vh;
}

/* CLEANER STATS BAR */
.stats {
  width: 95%;
  max-width: 800px;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 10px;
  padding: 15px;
  margin: 20px 0;
  border-radius: 15px;
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(5px);
  border: 2px solid #7a4a24;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  text-align: center;
}
.stat-item { display: flex; flex-direction: column; }
.stat-label { font-size: 0.75rem; text-transform: uppercase; font-weight: bold; color: #8b5a2b; }
.stat-value { font-size: 1.2rem; font-weight: bold; }
.gem-count { color: #008cff; }

/* BUTTONS */
button {
  padding: 10px 16px;
  border-radius: 12px;
  border: 2px solid #7a4a24;
  background: linear-gradient(#f6e3c2, #e2c89c);
  font-weight: bold;
  cursor: pointer;
  transition: transform .1s, filter 0.2s;
}
button:active { transform: scale(.95); }
button:hover { filter: brightness(1.05); }

/* COLLAPSIBLE TOGGLE */
.toggle-btn {
  float: right;
  padding: 2px 8px;
  font-size: 1.2rem;
  background: none;
  border: none;
  color: #7a4a24;
}

/* LOGIN BOX */
#loginBox {
  margin-top: 50px;
  padding: 25px;
  border-radius: 20px;
  background: #fff8e1;
  border: 4px solid #8b5a2b;
  box-shadow: 0 10px 30px rgba(0,0,0,0.3);
  text-align: center;
}

.cookie-btn {
  width: 220px;
  height: 220px;
  border-radius: 50%;
  border: none;
  margin: 30px;
  background: radial-gradient(circle at 30% 30%,rgba(255,255,255,0.4),rgba(0,0,0,0.4)), url("Cookies.jpg");
  background-size: cover;
  box-shadow: 0 10px 20px rgba(0,0,0,0.3);
  cursor: pointer;
}

/* PANELS */
.panel {
  position: fixed;
  bottom: 0;
  width: 100%;
  max-width: 900px;
  max-height: 85vh; 
  overflow-y: auto;
  background: #fdfaf4;
  transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  border-radius: 25px 25px 0 0;
  border-top: 8px solid #6b3e1e;
  padding: 20px;
  left: 50%;
  transform: translate(-50%, 110%);
  z-index: 100;
}
.panel.active { transform: translate(-50%, 0); }

.upgrade-card {
  background: #fff;
  border: 2px solid #e2c89c;
  border-radius: 15px;
  padding: 15px;
  margin-bottom: 15px;
}
.upgradeTable { width: 100%; border-collapse: collapse; margin-top: 10px; }
.upgradeTable.hidden { display: none; }
.upgradeTable td { padding: 10px 5px; border-bottom: 1px solid #eee; }

#toast {
  position: fixed;
  top: -100px;
  left: 50%;
  transform: translateX(-50%);
  padding: 15px 25px;
  background: #ffd36a;
  border: 3px solid #7a4a24;
  border-radius: 50px;
  font-weight: bold;
  transition: 0.5s;
  z-index: 1000;
}
#toast.show { top: 30px; }
</style>
</head>

<body>

<audio id="sClick" src="click.wav" preload="auto"></audio>
<audio id="sBuy" src="Upgrade.wav" preload="auto"></audio>
<audio id="sAch" src="Achievement.wav" preload="auto"></audio>

<div id="loginBox">
  <h2>Enter Bakery PIN</h2>
  <input id="pinInput" type="password" placeholder="PIN" style="padding:10px; border-radius:8px;">
  <button onclick="login()">Enter</button>
</div>

<div class="stats">
  <div class="stat-item"><span class="stat-label">Cookies</span><span id="count" class="stat-value">0</span></div>
  <div class="stat-item"><span class="stat-label">Gems</span><span id="gems" class="stat-value gem-count">0</span></div>
  <div class="stat-item"><span class="stat-label">Per Second</span><span id="cps" class="stat-value">0</span></div>
  <div class="stat-item"><span class="stat-label">Lifetime Clicks</span><span id="totalClicks" class="stat-value">0</span></div>
</div>

<button class="cookie-btn" onclick="clickCookie()"></button>

<div style="display:flex; gap:15px;">
  <button onclick="openPanel('upgrades')">Shop ‚Üë</button>
  <button onclick="openPanel('achievements')">Trophies üèÜ</button>
</div>

<div id="upgrades" class="panel">
  <button style="float:left" onclick="closePanels()">Back</button>
  <h2 style="text-align:center">Bakery Shop</h2>
  <div id="upgradeTables"></div>
</div>

<div id="achievements" class="panel">
  <button style="float:left" onclick="closePanels()">Back</button>
  <h2 style="text-align:center">Achievements</h2>
  <ul id="achievementList" style="padding:0"></ul>
</div>

<div id="toast"></div>

<script>
/* STATE */
let cookies = 0, gems = 0, cps = 0, clickPower = 1, pin = null;
let aI = 0, pI = 0, unlocked = {}, totalClicks = 0, totalPurchases = 0, playSeconds = 0;

const active = [
 ["Sugar Spoon", 25, "+1 CPC", 1],
 ["Golden Spoon", 150, "+4 CPC", 4],
 ["Diamond Whisk", 800, "+12 CPC", 12],
 ["Magic Rolling Pin", 4500, "+40 CPC", 40],
 ["Quantum Clicker", 25000, "+150 CPC", 150],
 ["Hyper-Press", 100000, "+500 CPC", 500]
];

const passive = [
 ["Grandma", 50, "+1 CPS", 1],
 ["Oven", 300, "+5 CPS", 5],
 ["Bakery", 2000, "+15 CPS", 15],
 ["Factory", 12000, "+50 CPS", 50],
 ["Industrial Mixer", 60000, "+180 CPS", 180],
 ["Cookie Planet", 500000, "+1200 CPS", 1200]
];

const achievements = [
 {id:"c1",n:"First Click",d:"Click the cookie once", g:"5" ,c:()=>cookies>=1},
 {id:"c100",n:"Cookie Lover",d:"Have 100 cookies", g:"10" ,c:()=>cookies>=100},
 {id:"c1000",n:"Cookie Hoarder",d:"Have 1,000 cookies", g:"15" ,c:()=>cookies>=1000},
 {id:"c10000",n:"Cookie Passionate",d:"Have 10,000 cookies", g:"20" ,c:()=>cookies>=10000},
 {id:"c100000",n:"Cookie Addict",d:"Have 100,000 cookies", g:"25" ,c:()=>cookies>=100000},
 {id:"c1m",n:"Millionaire",d:"Have 1,000,000 cookies", g:"30" ,c:()=>cookies>=1000000},
 {id:"up1",n:"First Upgrade",d:"Buy any upgrade", g:"5" ,c:()=>totalPurchases>=1}, 
 {id:"up6",n:"Almost There",d:"Buy any 6 upgrades", g:"25" ,c:()=>totalPurchases>=6},
 {id:"up12",n:"I'm Max",d:"Buy any 12 upgrades", g:"55" ,c:()=>totalPurchases>=12},
 {id:"cps5",n:"Automation I",d:"Reach 5 CPS", g:"5" ,c:()=>cps>=5},
 {id:"cps50",n:"Automation II",d:"Reach 50 CPS", g:"30" ,c:()=>cps>=50},
 {id:"cps250",n:"Automation III",d:"Reach 250 CPS", g:"60" ,c:()=>cps>=250},
 {id:"play5m",n:"Warmup",d:"Play for 5 minutes", g:"5" ,c:()=>playSeconds>=300},
 {id:"play5m",n:"Serious",d:"Play for 30 minutes", g:"30" ,c:()=>playSeconds>=1800},
 {id:"play5m",n:"Locked In",d:"Play for 1 hour", g:"60" ,c:()=>playSeconds>=3600}
];


const $ = i => document.getElementById(i);

function updateUI(){
 $("count").textContent = Math.floor(cookies);
 $("gems").textContent = gems;
 $("cps").textContent = cps;
 $("totalClicks").textContent = totalClicks;
 renderUpgrades();
 renderAchievements();
}

function renderUpgrades(){
 const container = $("upgradeTables");
 container.innerHTML = "";
 renderSection(container, "Clicking Upgrades", active, aI, buyActive, "active");
 renderSection(container, "Passive Income", passive, pI, buyPassive, "passive");
}

function renderSection(target, title, data, ownedIdx, buyFn, idPrefix) {
 const card = document.createElement("div");
 card.className = "upgrade-card";
 
 const isHidden = localStorage.getItem("hide_"+idPrefix) === "true";
 
 card.innerHTML = `
    <button class="toggle-btn" onclick="toggleSection('${idPrefix}')">${isHidden ? '‚Üë' : '‚Üì'}</button>
    <h3 style="margin:0">${title}</h3>
 `;
 
 const table = document.createElement("table");
 table.className = "upgradeTable" + (isHidden ? " hidden" : "");
 
 data.forEach((u, idx) => {
  const tr = document.createElement("tr");
  let action = idx < ownedIdx ? "Owned" : (idx === ownedIdx ? `<button onclick="event.stopPropagation(); buyUpgrade(${idx}, '${idPrefix}')" ${cookies < u[1] ? 'disabled' : ''}>Buy</button>` : "Locked");
  tr.innerHTML = `<td><b>${u[0]}</b><br><small>${u[2]}</small></td><td>üç™ ${u[1]}</td><td>${action}</td>`;
  table.appendChild(tr);
 });
 
 card.appendChild(table);
 target.appendChild(card);
}

function toggleSection(id) {
 const key = "hide_" + id;
 localStorage.setItem(key, localStorage.getItem(key) === "true" ? "false" : "true");
 updateUI();
}

function buyUpgrade(idx, type) {
 if (type === 'active') buyActive(idx); else buyPassive(idx);
}

function clickCookie(){
 cookies += clickPower; totalClicks++;
 playSnd("sClick"); checkAchievements(); updateUI();
}

function buyActive(index){
 if (index !== aI || cookies < active[index][1]) return;
 cookies -= active[index][1]; clickPower += active[index][3]; aI++; totalPurchases++;
 finishBuy();
}

function buyPassive(index){
 if (index !== pI || cookies < passive[index][1]) return;
 cookies -= passive[index][1]; cps += passive[index][3]; pI++; totalPurchases++;
 finishBuy();
}

function finishBuy() { playSnd("sBuy"); save(); updateUI(); checkAchievements(); }

function checkAchievements(){
 achievements.forEach(a=>{
  if(!unlocked[a.id] && a.c()){
   unlocked[a.id] = 1;
   gems += a.g;
   toast(`üèÜ ${a.n} (+${a.g} Gems)`);
   playSnd("sAch"); save();
  }
 });
}

function playSnd(id) { const a = $(id); if(a){ a.currentTime=0; a.play().catch(()=>{}); }}
function toast(t){ let d=$("toast"); d.textContent=t; d.classList.add("show"); setTimeout(()=>d.classList.remove("show"),3000); }
function openPanel(id){ closePanels(); $(id).classList.add("active"); }
function closePanels(){ $("upgrades").classList.remove("active"); $("achievements").classList.remove("active"); }

function save(){
 if(!pin) return;
 localStorage.setItem("cookie_"+pin, JSON.stringify({cookies, gems, aI, pI, unlocked, totalClicks, totalPurchases, playSeconds}));
}

function login(){
 pin = $("pinInput").value.trim();
 if(!pin) return alert("Enter PIN");
 try {
  let d = JSON.parse(localStorage.getItem("cookie_"+pin));
  if(d){
   cookies=d.cookies||0; gems=d.gems||0; aI=d.aI||0; pI=d.pI||0; 
   unlocked=d.unlocked||{}; totalClicks=d.totalClicks||0; 
   totalPurchases=d.totalPurchases||0; playSeconds=d.playSeconds||0;
   clickPower = 1 + active.slice(0, aI).reduce((s, u) => s + u[3], 0);
   cps = passive.slice(0, pI).reduce((s, u) => s + u[3], 0);
  }
 } catch (e) {}
 $("loginBox").style.display = "none";
 updateUI();
}

function renderAchievements(){
 let ul = $("achievementList"); ul.innerHTML = "";
 achievements.forEach(a=>{
  let li = document.createElement("li");
  li.style.listStyle = "none";
  li.style.padding = "10px";
  li.style.margin = "5px 0";
  li.style.borderRadius = "10px";
  li.style.border = "2px solid #7a4a24";
  li.style.background = unlocked[a.id] ? "#ffd36a" : "#eee";
  li.style.opacity = unlocked[a.id] ? "1" : "0.5";
  li.innerHTML = `<b>${a.n}</b><br><small>${a.d}</small><br><b style="color:#008cff">+${a.g} Gems</b>`;
  ul.appendChild(li);
 });
}

setInterval(()=>{
  if(!pin) return;
  cookies += cps; playSeconds++;
  checkAchievements(); save(); updateUI();
}, 1000);

updateUI();
</script>
</body>
</html>

